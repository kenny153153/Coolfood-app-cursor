import React, { createContext, useContext, useState, useCallback } from 'react';

export type Language = 'zh-HK' | 'en';

const translations = {
  'zh-HK': {
    orderStatus: {
      pending_payment: '待付款',
      processing: '處理中',
      ready_for_pickup: '等待收件',
      shipping: '運輸中',
      completed: '已完成',
      abnormal: '異常',
      refund: '已退款',
    },
    nav: {
      store: '商店',
      orders: '記錄',
      profile: '會員',
    },
    store: {
      login: '登入',
      goCheckout: '去結帳',
      addToCart: '立即選購',
      featuredPrice: '精選價',
      noCategories: '尚未有分類與商品',
      noCategoryProducts: '此分類沒有商品',
      addedToCart: '已加入購物車',
      bulkOff: '件+ 即減 ',
      percent: '%',
      dollar: '元',
    },
    checkout: {
      title: '結帳',
      deliveryMethod: '配送方式',
      homeDelivery: '送貨上門',
      sfLocker: '順豐自取',
      deliveryAddress: '收貨地址',
      fillAddress: '填寫收貨地址',
      changeAddress: '改用其他地址／填寫新地址',
      defaultAddress: '預設地址',
      shippingAddress: '收貨地址',
      registerForAddress: '註冊會員可以記錄預設地址，下次結帳更快捷。',
      goToProfile: '前往會員頁',
      addressLabel: '地址標籤（選填，如：屋企、公司）',
      district: '地區（如：九龍、旺角）',
      street: '街道／門牌',
      building: '大廈名稱',
      floor: '樓層',
      flat: '室／單位',
      contactName: '聯絡人姓名 *',
      contactPhone: '聯絡電話 *',
      saveAsDefault: '下次結帳時設為預設地址',
      cancel: '取消',
      saveAndUse: '保存並使用',
      productSummary: '產品摘要',
      subtotal: '商品小計',
      estimatedShipping: '預估運費',
      freeShipping: '已享全單免運優惠',
      totalAmount: '總金額',
      payNow: '立即支付',
      redirecting: '轉接中...',
      addressSaved: '已保存地址',
      fillRequired: '請填寫地區、地址、樓層、單位、收件人及手機號碼',
      fillContactAndAddress: '請填寫聯絡人、電話及至少一項地址',
    },
    orders: {
      myOrders: '我的訂單記錄',
      noOrders: '尚未有訂單',
      noTracking: '沒有物流編號',
      viewOrder: '查看訂單',
      trackLogistics: '追蹤物流',
      courier: '物流公司：順豐速運',
      logisticsStatus: '物流狀態：',
      trackingNo: '單號：',
      progress: '處理進度',
    },
    success: {
      paymentConfirmed: '付款已確認！',
      waybillGenerating: '順豐單號正自動生成中...',
      verifyingPayment: '正在與 Airwallex 核實付款紀錄...',
      sfWaybill: '順豐單號',
      waybillLater: '單號生成後會顯示於「記錄」頁面。',
      retryManual: '手動重試',
      viewOrders: '查看記錄',
      missingParams: '缺少訂單或支付參數，請從「記錄」進入或重新結帳。',
      thankYou: '多謝惠顧',
    },
    profile: {
      loginSignup: '會員登入 / 註冊',
      loginTab: '登入',
      signupTab: '註冊',
      emailOrPhone: '電郵或電話',
      password: '密碼',
      loginBtn: '登入',
      name: '姓名',
      phone: '電話',
      emailOptional: '電郵（選填）',
      passwordMin6: '密碼（至少 6 字）',
      signupBtn: '註冊',
      walletBalance: '錢包餘額',
      points: '累積積分',
      addresses: '收貨地址/聯絡人',
      addAddress: '新增地址/聯絡人',
      openAdmin: '開啟管理後台',
      logout: '退出登入',
      loggedOut: '已成功登出',
      default: '預設',
      welcomeBack: '歡迎回來！',
      signupSuccess: '註冊成功！',
      enterEmailOrPhone: '請輸入電郵或電話及密碼',
      accountNotFound: '找不到此帳戶',
      wrongPassword: '密碼錯誤',
      fillNamePhonePassword: '請填寫姓名、電話及密碼',
      passwordMin6Error: '密碼至少 6 個字元',
      phoneRegistered: '此電話已被註冊',
      emailRegistered: '此電郵已被註冊',
      loginFailed: '登入失敗',
      signupFailed: '註冊失敗',
    },
    address: {
      newAddress: '新增地址',
      editAddress: '編輯地址',
      label: '標籤',
      labelPlaceholder: '如：屋企、公司',
      districtRequired: '地區 *',
      selectDistrict: '請選擇地區',
      addressRequired: '地址 *',
      addressPlaceholder: '街道／門牌／村屋等',
      floorRequired: '樓層 *',
      floorPlaceholder: '如：3',
      flatRequired: '室／單位 *',
      flatPlaceholder: '如：B',
      contactNameRequired: '收件人名稱 *',
      phoneRequired: '手機號碼 *',
      altContact: '後備收件人',
      altPhone: '後備收件人手機號碼',
      setDefault: '設為預設地址',
      save: '保存',
      cancel: '取消',
      setAsDefault: '已設為預設地址',
      added: '地址已新增',
      updated: '地址已更新',
      deleted: '地址已刪除',
      memberNotFound: '會員資料不存在',
      fillRequired: '請填寫地區、地址、樓層、單位、收件人及手機號碼',
    },
    admin: {
      loginTitle: '管理後台登入',
      account: '帳號',
      accountPlaceholder: '輸入帳號',
      password: '密碼',
      passwordPlaceholder: '輸入密碼',
      loginBtn: '登入後台',
      backToFront: '返回前台',
      loginSuccess: '後台登入成功',
      loginError: '帳號或密碼錯誤',
      controlCenter: '智控中心',
      collapseSidebar: '收起選單',
      exitAdmin: '離開後台',
      realtimeAdmin: '實時管理後台',
      dashboard: '儀表板',
      inventory: '產品/分類',
      orders: '訂單',
      members: '會員管理',
      slideshow: '廣告輪播',
      settings: '系統設定',
      dashboardStats: {
        revenue: '今日營收',
        pendingOrders: '待處理訂單',
        newMembers: '新增會員',
        stockAlert: '庫存預警',
        needRestock: '需補貨',
      },
      aiSuggestions: 'AI 經營建議',
      generateReport: '生成分析報告',
      aiAnalyzing: 'Gemini 正在分析實時數據...',
      aiDefault: '點擊按鈕獲取由 Gemini 3 Pro 提供的專業經營策略。',
      notificationWip: '通知功能開發中',
      accountWip: '帳戶功能開發中',
      productManagement: '產品管理',
      categorySettings: '分類設定',
      pricingDeliveryRules: '價格與配送規則',
      searchProducts: '搜索產品...',
      downloadTemplate: '下載模板',
      bulkUploadCSV: '批量上傳 CSV',
      addNewProduct: '上架新產品',
      product: '產品',
      category: '分類',
      stock: '庫存',
      actions: '操作',
      noProducts: '尚未有產品',
      items: '件',
      unlimited: '無限量',
      deleteProduct: '刪除產品',
      confirmDeleteProduct: '確定刪除 {name} 嗎？此操作無法復原。',
      editProduct: '編輯產品',
      productName: '名稱',
      productId: '商品 ID',
      price: '價格',
      memberPrice: '會員價',
      stockLabel: '庫存',
      trackInventory: '是否追蹤庫存',
      yes: '是',
      no: '否',
      categoriesComma: '分類 (逗號分隔)',
      tagsComma: '標籤 (逗號分隔)',
      imageField: '圖片 (Emoji 或 URL)',
      description: '商品描述',
      cancel: '取消',
      save: '保存',
      enterProductName: '請輸入產品名稱',
      productSaved: '產品保存失敗',
      productDeleted: '產品已刪除',
      categoryList: '分類列表',
      addNew: '新增',
      noCategories: '尚未有分類',
      editCategory: '編輯分類',
      categoryId: '分類 ID',
      categoryName: '分類名稱',
      icon: '圖示',
      enterCategoryName: '請輸入分類名稱',
      deleteCategory: '刪除分類',
      confirmDeleteCategory: '確定刪除 {name} 嗎？此操作無法復原。',
      categorySaved: '分類保存失敗',
      categoryDeleted: '分類已刪除',
      rulesActive: '規則管理已啟動',
      rulesHint: '請前往系統設定調整全局定價與配送規則。',
      searchOrders: '搜索訂單編號或客戶名稱...',
      all: '全部',
      orderId: '訂單編號',
      customer: '客戶',
      amount: '金額',
      status: '狀態',
      date: '日期',
      noOrders: '尚未有訂單',
      searchMembers: '搜索姓名、電郵或電話...',
      addMember: '新增會員',
      noMembers: '尚未有會員',
      wallet: '錢包',
      pointsLabel: '積分',
      slideshowHint: '首頁輪播廣告，可放圖片或影片連結',
      addSlideshow: '新增廣告',
      noTitle: '（無標題）',
      order: '順序',
      editSlideshow: '編輯廣告',
      slideshowType: '類型',
      image: '圖片',
      video: '影片',
      slideshowUrl: '連結 (圖片或影片 URL)',
      slideshowTitle: '標題（選填）',
      slideshowTitlePlaceholder: '廣告標題',
      slideshowOrder: '順序 (數字越小越前)',
      enterUrl: '請輸入連結',
      slideshowSaved: '廣告已保存',
      deleteSlideshow: '刪除廣告',
      confirmDeleteSlideshow: '確定要刪除此則廣告？',
      slideshowDeleted: '廣告已刪除',
      basicInfo: '基本資訊',
      storeName: '商店名稱',
      logoIcon: 'Logo 圖標',
      globalPricing: '全局定價規則',
      vipDiscount: 'VIP 會員折扣 (%)',
      applyUpdatePricing: '套用並更新所有會員價',
      pricingApplied: '價格規則已套用',
      editMember: '調整會員帳戶',
      editing: '編輯',
      basicData: '基本資料',
      memberName: '姓名',
      memberPhone: '電話',
      memberEmailOptional: '電郵（選填）',
      memberPasswordHint: '密碼（留空不更改；新會員請填）',
      walletManagement: '錢包管理',
      currentBalance: '當前餘額',
      enterName: '請輸入姓名',
      enterPhone: '請輸入電話',
      newMemberPasswordRequired: '新會員請設定密碼（至少 6 字）',
      passwordMin6: '密碼至少 6 個字元',
      saveAndClose: '保存並關閉',
      dataSaved: '資料已保存',
      orderDetail: {
        lineItems: '商品明細',
        noLineItems: '沒有商品明細',
        noImage: '無圖',
        deliveryAndContact: '配送方式及聯絡人',
        notSet: '未設定',
        noAddress: '未提供地址',
        contact: '聯絡人：',
        notProvided: '未提供',
        amountDetail: '金額明細',
        subtotal: '小計',
        shippingFee: '運費',
        total: '總計',
        customerLabel: '客戶',
        noPhone: '未提供電話',
        logistics: '物流資訊',
        courier: '物流公司：順豐速運',
        logisticsStatus: '物流狀態：',
        trackingNo: '單號：',
        lastUpdate: '最後更新：',
        orderStatus: '訂單狀態',
        trackingNumber: '物流編號',
        trackingPlaceholder: '輸入物流編號',
        close: '關閉',
        updateOrder: '更新訂單',
        orderPlaced: '下單完成',
      },
      confirm: '確認',
    },
    common: {
      loading: '載入中...',
      error: '錯誤',
      success: '成功',
      confirm: '確認',
      cancel: '取消',
      save: '保存',
      delete: '刪除',
      edit: '編輯',
      close: '關閉',
      back: '返回',
      noTrackingNumber: '沒有物流編號',
    },
    toast: {
      orderSubmitted: '訂單已提交！正在轉接支付接口...',
      orderSubmitFailed: '訂單提交失敗',
      orderLoadFailed: '訂單資料載入失敗',
      orderUpdateFailed: '訂單更新失敗',
      orderIdInvalid: '訂單編號無效',
      productLoadFailed: '產品資料載入失敗',
      categoryLoadFailed: '分類資料載入失敗',
      memberLoadFailed: '會員資料載入失敗',
      memberSaveFailed: '會員保存失敗',
      productBulkSaveFailed: '產品批量保存失敗',
      productDeleteFailed: '產品刪除失敗',
      categorySaveFailed: '分類保存失敗',
      categoryDeleteFailed: '分類刪除失敗',
      slideshowSaveFailed: '廣告保存失敗',
      slideshowDeleteFailed: '廣告刪除失敗',
      bulkUploadSuccess: '成功批量上傳 {count} 個產品',
      addressFilled: '已填入地址，請補上樓層及室號',
      locationTimeout: '定位逾時，請手動填寫地址',
      locationDenied: '無法取得位置，請允許定位或手動填寫地址',
      mapLoadFailed: '無法載入地圖服務，請手動填寫地址',
      addressFetchFailed: '無法取得地址，請手動填寫',
      setGoogleMapsKey: '請在 .env.local 設定 GOOGLE_MAPS_API_KEY',
      browserNoLocation: '此瀏覽器不支援定位，請手動填寫地址',
    },
    schema: {
      members: '請在 Supabase SQL Editor 執行 supabase-members-schema.sql 建立 members 表',
      products: '請在 Supabase SQL Editor 執行 supabase-products-schema.sql 建立 products 表',
      categories: '請在 Supabase SQL Editor 執行 supabase-categories-schema.sql 建立 categories 表',
      orders: '請在 Supabase SQL Editor 執行 supabase-orders-schema.sql 建立 orders 表',
      slideshow: '請在 Supabase SQL Editor 執行 supabase-slideshow-schema.sql 建立 slideshow 表',
      defaultHint: '請先在 Supabase 建立 {table} 表',
    },
  },
  en: {
    orderStatus: {
      pending_payment: 'Pending Payment',
      processing: 'Processing',
      ready_for_pickup: 'Ready for Pickup',
      shipping: 'Shipping',
      completed: 'Completed',
      abnormal: 'Abnormal',
      refund: 'Refunded',
    },
    nav: {
      store: 'Store',
      orders: 'Orders',
      profile: 'Profile',
    },
    store: {
      login: 'Login',
      goCheckout: 'Checkout',
      addToCart: 'Add to Cart',
      featuredPrice: 'Price',
      noCategories: 'No categories or products yet',
      noCategoryProducts: 'No products in this category',
      addedToCart: 'Added to cart',
      bulkOff: 'pcs+ save ',
      percent: '%',
      dollar: '$',
    },
    checkout: {
      title: 'Checkout',
      deliveryMethod: 'Delivery Method',
      homeDelivery: 'Home Delivery',
      sfLocker: 'SF Locker',
      deliveryAddress: 'Delivery Address',
      fillAddress: 'Enter delivery address',
      changeAddress: 'Change / Add new address',
      defaultAddress: 'Default Address',
      shippingAddress: 'Shipping Address',
      registerForAddress: 'Register to save your default address for faster checkout next time.',
      goToProfile: 'Go to Profile',
      addressLabel: 'Address label (optional, e.g. Home, Office)',
      district: 'District (e.g. Kowloon, Mong Kok)',
      street: 'Street / Number',
      building: 'Building name',
      floor: 'Floor',
      flat: 'Unit / Flat',
      contactName: 'Contact name *',
      contactPhone: 'Contact phone *',
      saveAsDefault: 'Set as default address for next checkout',
      cancel: 'Cancel',
      saveAndUse: 'Save & Use',
      productSummary: 'Order Summary',
      subtotal: 'Subtotal',
      estimatedShipping: 'Est. Shipping',
      freeShipping: 'Free shipping applied',
      totalAmount: 'Total',
      payNow: 'Pay Now',
      redirecting: 'Redirecting...',
      addressSaved: 'Address saved',
      fillRequired: 'Please fill in district, address, floor, unit, contact name and phone',
      fillContactAndAddress: 'Please fill in contact, phone and at least one address field',
    },
    orders: {
      myOrders: 'My Orders',
      noOrders: 'No orders yet',
      noTracking: 'No tracking number',
      viewOrder: 'View Order',
      trackLogistics: 'Track',
      courier: 'Courier: SF Express',
      logisticsStatus: 'Status: ',
      trackingNo: 'Tracking: ',
      progress: 'Progress',
    },
    success: {
      paymentConfirmed: 'Payment Confirmed!',
      waybillGenerating: 'SF waybill is being generated...',
      verifyingPayment: 'Verifying payment with Airwallex...',
      sfWaybill: 'SF Waybill No.',
      waybillLater: 'The waybill number will appear on the Orders page.',
      retryManual: 'Retry Manually',
      viewOrders: 'View Orders',
      missingParams: 'Missing order or payment parameters. Please go to Orders or checkout again.',
      thankYou: 'Thank you for your purchase',
    },
    profile: {
      loginSignup: 'Login / Sign Up',
      loginTab: 'Login',
      signupTab: 'Sign Up',
      emailOrPhone: 'Email or Phone',
      password: 'Password',
      loginBtn: 'Login',
      name: 'Name',
      phone: 'Phone',
      emailOptional: 'Email (optional)',
      passwordMin6: 'Password (min 6 chars)',
      signupBtn: 'Sign Up',
      walletBalance: 'Wallet Balance',
      points: 'Points',
      addresses: 'Addresses / Contacts',
      addAddress: 'Add Address / Contact',
      openAdmin: 'Open Admin Panel',
      logout: 'Logout',
      loggedOut: 'Logged out successfully',
      default: 'Default',
      welcomeBack: 'Welcome back!',
      signupSuccess: 'Registration successful!',
      enterEmailOrPhone: 'Please enter email or phone and password',
      accountNotFound: 'Account not found',
      wrongPassword: 'Wrong password',
      fillNamePhonePassword: 'Please fill in name, phone and password',
      passwordMin6Error: 'Password must be at least 6 characters',
      phoneRegistered: 'This phone number is already registered',
      emailRegistered: 'This email is already registered',
      loginFailed: 'Login failed',
      signupFailed: 'Registration failed',
    },
    address: {
      newAddress: 'New Address',
      editAddress: 'Edit Address',
      label: 'Label',
      labelPlaceholder: 'e.g. Home, Office',
      districtRequired: 'District *',
      selectDistrict: 'Select district',
      addressRequired: 'Address *',
      addressPlaceholder: 'Street / Building / Village etc.',
      floorRequired: 'Floor *',
      floorPlaceholder: 'e.g. 3',
      flatRequired: 'Unit / Flat *',
      flatPlaceholder: 'e.g. B',
      contactNameRequired: 'Recipient name *',
      phoneRequired: 'Phone *',
      altContact: 'Alt. Contact',
      altPhone: 'Alt. Contact Phone',
      setDefault: 'Set as default address',
      save: 'Save',
      cancel: 'Cancel',
      setAsDefault: 'Set as default address',
      added: 'Address added',
      updated: 'Address updated',
      deleted: 'Address deleted',
      memberNotFound: 'Member not found',
      fillRequired: 'Please fill in district, address, floor, unit, contact name and phone',
    },
    admin: {
      loginTitle: 'Admin Login',
      account: 'Username',
      accountPlaceholder: 'Enter username',
      password: 'Password',
      passwordPlaceholder: 'Enter password',
      loginBtn: 'Login to Admin',
      backToFront: 'Back to Store',
      loginSuccess: 'Admin login successful',
      loginError: 'Invalid username or password',
      controlCenter: 'Control Center',
      collapseSidebar: 'Collapse',
      exitAdmin: 'Exit Admin',
      realtimeAdmin: 'Real-time Admin',
      dashboard: 'Dashboard',
      inventory: 'Products / Categories',
      orders: 'Orders',
      members: 'Members',
      slideshow: 'Slideshow',
      settings: 'Settings',
      dashboardStats: {
        revenue: "Today's Revenue",
        pendingOrders: 'Pending Orders',
        newMembers: 'New Members',
        stockAlert: 'Stock Alerts',
        needRestock: 'Need restock',
      },
      aiSuggestions: 'AI Business Insights',
      generateReport: 'Generate Report',
      aiAnalyzing: 'Gemini is analyzing real-time data...',
      aiDefault: 'Click to get professional business strategies from Gemini 3 Pro.',
      notificationWip: 'Notifications coming soon',
      accountWip: 'Account settings coming soon',
      productManagement: 'Product Management',
      categorySettings: 'Category Settings',
      pricingDeliveryRules: 'Pricing & Delivery Rules',
      searchProducts: 'Search products...',
      downloadTemplate: 'Download Template',
      bulkUploadCSV: 'Bulk Upload CSV',
      addNewProduct: 'Add New Product',
      product: 'Product',
      category: 'Category',
      stock: 'Stock',
      actions: 'Actions',
      noProducts: 'No products yet',
      items: 'pcs',
      unlimited: 'Unlimited',
      deleteProduct: 'Delete Product',
      confirmDeleteProduct: 'Are you sure you want to delete {name}? This cannot be undone.',
      editProduct: 'Edit Product',
      productName: 'Name',
      productId: 'Product ID',
      price: 'Price',
      memberPrice: 'Member Price',
      stockLabel: 'Stock',
      trackInventory: 'Track Inventory',
      yes: 'Yes',
      no: 'No',
      categoriesComma: 'Categories (comma separated)',
      tagsComma: 'Tags (comma separated)',
      imageField: 'Image (Emoji or URL)',
      description: 'Description',
      cancel: 'Cancel',
      save: 'Save',
      enterProductName: 'Please enter product name',
      productSaved: 'Product save failed',
      productDeleted: 'Product deleted',
      categoryList: 'Category List',
      addNew: 'Add New',
      noCategories: 'No categories yet',
      editCategory: 'Edit Category',
      categoryId: 'Category ID',
      categoryName: 'Category Name',
      icon: 'Icon',
      enterCategoryName: 'Please enter category name',
      deleteCategory: 'Delete Category',
      confirmDeleteCategory: 'Are you sure you want to delete {name}? This cannot be undone.',
      categorySaved: 'Category save failed',
      categoryDeleted: 'Category deleted',
      rulesActive: 'Rules Management Active',
      rulesHint: 'Go to Settings to adjust global pricing and delivery rules.',
      searchOrders: 'Search order ID or customer name...',
      all: 'All',
      orderId: 'Order ID',
      customer: 'Customer',
      amount: 'Amount',
      status: 'Status',
      date: 'Date',
      noOrders: 'No orders yet',
      searchMembers: 'Search name, email or phone...',
      addMember: 'Add Member',
      noMembers: 'No members yet',
      wallet: 'Wallet',
      pointsLabel: 'Points',
      slideshowHint: 'Homepage slideshow ads. Supports images and video links.',
      addSlideshow: 'Add Slide',
      noTitle: '(No title)',
      order: 'Order',
      editSlideshow: 'Edit Slide',
      slideshowType: 'Type',
      image: 'Image',
      video: 'Video',
      slideshowUrl: 'URL (Image or Video)',
      slideshowTitle: 'Title (optional)',
      slideshowTitlePlaceholder: 'Slide title',
      slideshowOrder: 'Sort order (lower = first)',
      enterUrl: 'Please enter URL',
      slideshowSaved: 'Slide saved',
      deleteSlideshow: 'Delete Slide',
      confirmDeleteSlideshow: 'Are you sure you want to delete this slide?',
      slideshowDeleted: 'Slide deleted',
      basicInfo: 'Basic Info',
      storeName: 'Store Name',
      logoIcon: 'Logo Icon',
      globalPricing: 'Global Pricing Rules',
      vipDiscount: 'VIP Discount (%)',
      applyUpdatePricing: 'Apply & Update All Member Prices',
      pricingApplied: 'Pricing rules applied',
      editMember: 'Edit Member',
      editing: 'Editing',
      basicData: 'Basic Info',
      memberName: 'Name',
      memberPhone: 'Phone',
      memberEmailOptional: 'Email (optional)',
      memberPasswordHint: 'Password (leave blank to keep; required for new members)',
      walletManagement: 'Wallet Management',
      currentBalance: 'Current Balance',
      enterName: 'Please enter name',
      enterPhone: 'Please enter phone',
      newMemberPasswordRequired: 'New members must set a password (min 6 chars)',
      passwordMin6: 'Password must be at least 6 characters',
      saveAndClose: 'Save & Close',
      dataSaved: 'Data saved',
      orderDetail: {
        lineItems: 'Line Items',
        noLineItems: 'No line items',
        noImage: 'No img',
        deliveryAndContact: 'Delivery & Contact',
        notSet: 'Not set',
        noAddress: 'No address provided',
        contact: 'Contact: ',
        notProvided: 'Not provided',
        amountDetail: 'Amount Details',
        subtotal: 'Subtotal',
        shippingFee: 'Shipping',
        total: 'Total',
        customerLabel: 'Customer',
        noPhone: 'No phone provided',
        logistics: 'Logistics',
        courier: 'Courier: SF Express',
        logisticsStatus: 'Status: ',
        trackingNo: 'Tracking: ',
        lastUpdate: 'Last update: ',
        orderStatus: 'Order Status',
        trackingNumber: 'Tracking Number',
        trackingPlaceholder: 'Enter tracking number',
        close: 'Close',
        updateOrder: 'Update Order',
        orderPlaced: 'Order placed',
      },
      confirm: 'Confirm',
    },
    common: {
      loading: 'Loading...',
      error: 'Error',
      success: 'Success',
      confirm: 'Confirm',
      cancel: 'Cancel',
      save: 'Save',
      delete: 'Delete',
      edit: 'Edit',
      close: 'Close',
      back: 'Back',
      noTrackingNumber: 'No tracking number',
    },
    toast: {
      orderSubmitted: 'Order submitted! Redirecting to payment...',
      orderSubmitFailed: 'Order submission failed',
      orderLoadFailed: 'Failed to load orders',
      orderUpdateFailed: 'Order update failed',
      orderIdInvalid: 'Invalid order ID',
      productLoadFailed: 'Failed to load products',
      categoryLoadFailed: 'Failed to load categories',
      memberLoadFailed: 'Failed to load members',
      memberSaveFailed: 'Member save failed',
      productBulkSaveFailed: 'Bulk product save failed',
      productDeleteFailed: 'Product delete failed',
      categorySaveFailed: 'Category save failed',
      categoryDeleteFailed: 'Category delete failed',
      slideshowSaveFailed: 'Slide save failed',
      slideshowDeleteFailed: 'Slide delete failed',
      bulkUploadSuccess: 'Successfully uploaded {count} products',
      addressFilled: 'Address filled in. Please add floor and unit.',
      locationTimeout: 'Location timed out. Please enter address manually.',
      locationDenied: 'Cannot get location. Please allow location or enter manually.',
      mapLoadFailed: 'Cannot load map service. Please enter address manually.',
      addressFetchFailed: 'Cannot get address. Please enter manually.',
      setGoogleMapsKey: 'Please set GOOGLE_MAPS_API_KEY in .env.local',
      browserNoLocation: 'This browser does not support geolocation. Please enter address manually.',
    },
    schema: {
      members: 'Please run supabase-members-schema.sql in Supabase SQL Editor',
      products: 'Please run supabase-products-schema.sql in Supabase SQL Editor',
      categories: 'Please run supabase-categories-schema.sql in Supabase SQL Editor',
      orders: 'Please run supabase-orders-schema.sql in Supabase SQL Editor',
      slideshow: 'Please run supabase-slideshow-schema.sql in Supabase SQL Editor',
      defaultHint: 'Please create the {table} table in Supabase first',
    },
  },
} as const;

export type Translations = typeof translations['zh-HK'];

interface I18nContextType {
  lang: Language;
  setLang: (lang: Language) => void;
  t: Translations;
}

export const I18nContext = createContext<I18nContextType>({
  lang: 'zh-HK',
  setLang: () => {},
  t: translations['zh-HK'],
});

export const useI18n = () => useContext(I18nContext);

export const I18nProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [lang, setLangState] = useState<Language>(() => {
    try {
      const stored = localStorage.getItem('coolfood_lang');
      if (stored === 'en' || stored === 'zh-HK') return stored;
    } catch {}
    return 'zh-HK';
  });

  const setLang = useCallback((newLang: Language) => {
    setLangState(newLang);
    try { localStorage.setItem('coolfood_lang', newLang); } catch {}
  }, []);

  const t = translations[lang];

  return React.createElement(I18nContext.Provider, { value: { lang, setLang, t } }, children);
};
